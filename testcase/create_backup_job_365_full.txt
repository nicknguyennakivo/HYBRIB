@testcase backup_m365_full
@max_wait 30
@poll_interval 2

@pre

@run
Type "admin" on the username input.
Type "admin" on password input.
Expect "Log In" to be visible.
Click the "Log In" button.
Expect "Data Protection" to be visible.

Open the Data Protection menu.
@execute Click icon button used to create a new job.
Expect "Backup for Microsoft 365" to be visible.
Select "Backup for Microsoft 365" as the job type.
Expect "Sources" to be visible.

Type "danh07emptygr" on the source search input.
Press Enter.
Select the checkbox labeled "danh07emptygr" Group Mailboxes.
Expect "danh07emptygr" Group Mailboxes to be visible in the right panel.
Click Next.
Expect "Destination" to be visible.

Click the destination repository dropdown.
Select "365_Backup".
Click Next.
Expect "Schedule" to be visible.

Ensure "Do not schedule, run on demand" is selected.
Click Next.
Expect "Options" to be visible.

Type "test_365" on the Job Name field.
Click the "Finish & Run" button.
Expect "Run this job?" to be visible.

Click the "Run" button.
Wait until the job status in Job Info is not "Running".
Expect the job status to be "Completed".

Click the Settings menu.
Click the Repositories section.
Select "365_Backup".
Expect "danh07emptygr" Group Mailboxes to be visible in the backup list.
